<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>نظام التقارير العسكرية الذكي</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');

:root {
  --primary-blue: #00d4ff;
  --dark-bg: #0a0a0a;
  --card-bg: rgba(20,20,20,.8);
  --border-color: rgba(0,212,255,.2);
  --text-gray: #b0b0b0;
}

body {
  margin: 0;
  font-family: 'Cairo', sans-serif;
  background: radial-gradient(circle,#1a1a1a,#050505);
  color: #fff;
  min-height: 100vh;
  overflow-y: auto;
  padding: 20px 0;
}

/* خلفية متحركة لشعارين */
body::before, body::after {
  content: "";
  position: fixed;
  background-repeat: no-repeat;
  background-size: contain;
  opacity: 0.15;
  pointer-events: none;
  z-index: 0;
  animation: floatAnim 15s ease-in-out infinite alternate;
}

body::before {
  top: 10px;
  left: 10px;
  width: 100px;
  height: 100px;
  background-image: url('logo1.gif');
}

body::after {
  bottom: 10px;
  right: 10px;
  width: 120px;
  height: 120px;
  background-image: url('logo2.gif');
  animation-delay: 7.5s;
}

@keyframes floatAnim {
  0% { transform: translateY(0); }
  100% { transform: translateY(15px); }
}

.container {
  width: 90%;
  max-width: 500px;
  background: var(--card-bg);
  backdrop-filter: blur(15px);
  border: 1px solid var(--border-color);
  border-radius: 20px;
  padding: 35px;
  box-shadow: 0 20px 50px rgba(0,0,0,.5);
  margin: 0 auto;
  position: relative;
  z-index: 1;
}

h2 {
  text-align: center;
  color: var(--primary-blue);
  margin-bottom: 30px;
}

.main-menu {
  display: grid;
  gap: 15px;
}

.menu-card {
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.05);
  padding: 20px;
  border-radius: 15px;
  cursor: pointer;
  display: flex;
  gap: 15px;
  align-items: center;
  transition: .3s;
  color: #fff;
}

.menu-card:hover {
  background: rgba(0,212,255,.08);
  border-color: var(--primary-blue);
  transform: translateX(-5px);
}

.menu-card i {
  color: var(--primary-blue);
  font-size: 22px;
}

.form-group {
  margin-bottom: 20px;
}

label {
  display: block;
  margin-bottom: 8px;
  font-size: 14px;
  color: var(--text-gray);
  font-weight: 600;
}

input, select, textarea {
  width: 100%;
  padding: 12px;
  background: rgba(255,255,255,.05);
  border: 1px solid rgba(255,255,255,.1);
  border-radius: 10px;
  color: #fff;
  font-family: 'Cairo';
}

select {
  color: black !important;
}

.time-input-group {
  display: flex;
  align-items: center;
  gap: 8px;
  direction: ltr;
}

.btn-copy {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg,#00829d,#00d4ff);
  border: none;
  border-radius: 10px;
  color: #fff;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
  margin-top: 20px;
}

.back-link {
  margin-top: 30px;
  text-align: center;
  font-size: 14px;
  cursor: pointer;
  color: var(--text-gray);
}

#form-section { display: none; }

footer {
  margin-top: 30px;
  text-align: center;
  font-size: 12px;
  color: var(--text-gray);
  position: relative;
  z-index: 1;
  padding-bottom: 10px;
}
</style>
</head>

<body>

<div class="container">

  <div id="menu-section">
    <h2><i class="fas fa-shield-alt"></i> بوليتو - التقارير</h2>
    <div class="main-menu">
      <div class="menu-card" onclick="openForm('supervision')">
        <i class="fas fa-user-shield"></i>
        <strong>تقارير الإشراف</strong>
      </div>
      <div class="menu-card" onclick="openForm('zone')">
        <i class="fas fa-map-marker-alt"></i>
        <strong>تقارير ضابط منطقة</strong>
      </div>
      <div class="menu-card" onclick="openForm('courses')">
        <i class="fas fa-graduation-cap"></i>
        <strong>تقارير الدورات</strong>
      </div>
    </div>
  </div>

  <div id="form-section">
    <h2 id="title-text">تقديم التقرير</h2>

    <div class="form-group">
      <label>التوجيه</label>
      <input type="text" id="taskName" oninput="handleTaskInput()" autocomplete="off" />
    </div>

    <div class="form-group">
      <label>الموقع</label>
      <input type="text" id="location" />
    </div>

    <div class="form-group">
      <label>الرتبة</label>
      <select id="rank"></select>
    </div>

    <div class="form-group" id="unit-group">
      <label id="unit-label">الـجــهــات الامــنـيــة المـــتــواجــده</label>
      <textarea id="unit" rows="3" readonly></textarea>
    </div>

    <div class="form-group">
      <label>الكوبي ايدي</label>
      <input type="text" id="militaryID" />
    </div>

    <div class="form-group">
      <label>هل التقرير بدري؟</label>
      <select id="earlyReport" onchange="toggleReason()">
        <option value="no" selected>لا</option>
        <option value="yes">نعم</option>
      </select>
    </div>

    <div class="form-group" id="reason-group" style="display:none">
      <label>سبب التبكير</label>
      <select id="earlyReason">
        <option value="ريستارت">ريستارت</option>
        <option value="صيانة">صيانة</option>
        <option value="اعادة اصطفاف">إعادة اصطفاف</option>
      </select>
    </div>

    <button class="btn-copy" onclick="copyReport()">نسخ التقرير النهائي</button>

    <div class="back-link" onclick="goBack()">الرجوع إلى القائمة الرئيسية</div>

  </div>

</div>

<footer>
  حقوق الملكية © قطاع الأمن العام بمقاطعة بوليتو
</footer>

<script>
const el = (id) => document.getElementById(id);

let currentMode = "";
const fixedUnits = "الامــن الــعـام + امـن الـطـرق + المهام والواجبات الخاصه";

const supervisionRanks = ["عميد ركن","عقيد ركن","مقدم ركن","رائد","نقيب","ملازم اول","ملازم"];

// التوجيهات والمواقع
const taskMap = {
  "سهم 1": "ساندي + بوليتو",
  "سهم 2": "ساندي + بوليتو",
  "سهم 3": "ساندي + بوليتو",
  "سهم 4": "ساندي + بوليتو",
  "سهم 5": "ساندي + بوليتو",
  "درع 1": "ساندي + بوليتو",
  "درع 2": "ساندي + بوليتو",
  "درع 3": "ساندي + بوليتو",
  "درع 4": "ساندي + بوليتو",
  "درع 5": "ساندي + بوليتو",
  "جنوب 1": "ساندي",
  "جنوب 2": "ساندي",
  "جنوب 3": "ساندي",
  "جنوب 4": "ساندي",
  "غرب 1": "بوليتو",
  "غرب 2": "بوليتو",
  "غرب 3": "بوليتو",
  "غرب 4": "بوليتو",
  "ساهر 1": "جيم + لام",
  "ساهر 2": "جيم + لام",
  "ساهر 3": "دال",
  "ساهر 4": "دال",
  "رصد": "جيم + لام + دال",
  "سيف": "جيم + لام + دال"
};

// فتح الفورم
function openForm(type) {
  currentMode = type;
  el("menu-section").style.display = "none";
  el("form-section").style.display = "block";
  updateRankOptions(supervisionRanks);
  el("unit").value = fixedUnits;
}

// العودة للقائمة
function goBack() {
  el("menu-section").style.display = "block";
  el("form-section").style.display = "none";
}

// تحديث الرتب
function updateRankOptions(ranks) {
  const rankSelect = el("rank");
  rankSelect.innerHTML = "<option disabled selected>اختر الرتبة</option>";
  ranks.forEach(r => { rankSelect.innerHTML += `<option>${r}</option>`; });
}

// تحديث الموقع تلقائيًا حسب التوجيه
function handleTaskInput() {
  const taskInput = el("taskName").value.trim();
  let matchedLocations = [];
  for(const key in taskMap) {
    if(taskInput.includes(key)) matchedLocations.push(taskMap[key]);
  }
  if(matchedLocations.length > 0) {
    let currentLocation = el("location").value;
    matchedLocations.forEach(locText => {
      if(!currentLocation.includes(locText)) {
        if(currentLocation.length>0 && !currentLocation.endsWith(" + ")) currentLocation += " + ";
        currentLocation += locText;
      }
    });
    el("location").value = currentLocation;
  }
}

// إظهار سبب التبكير
function toggleReason() {
  const early = el("earlyReport").value;
  el("reason-group").style.display = early === "yes" ? "block" : "none";
}

// الحصول على الوقت بتوقيت السعودية مع خصم ساعة
function getSaudiTimeMinusHour() {
  let now = new Date();
  // تحويل التوقيت إلى السعودية (UTC+3)
  let utc = now.getTime() + (now.getTimezoneOffset() * 60000);
  let saudiTime = new Date(utc + 3*3600000);
  // خصم ساعة
  saudiTime.setHours(saudiTime.getHours() -1);
  return saudiTime;
}

// تحويل وقت 24 ساعة إلى 12 ساعة
function to12Hour(date) {
  let h = date.getHours();
  let m = date.getMinutes();
  let p = h >= 12 ? "م" : "ص";
  if(h === 0) h = 12;
  if(h > 12) h -=12;
  return {h:h<10?"0"+h:h.toString(), m:m<10?"0"+m:m.toString(), p};
}

// نسخ التقرير النهائي
function copyReport() {
  const task = el("taskName").value.trim() || "...";
  const loc = el("location").value.trim() || "...";
  const rank = el("rank").value || "...";
  const id = el("militaryID").value || "0000";
  const unitText = fixedUnits;

  // الوقت
  let startDate = getSaudiTimeMinusHour();
  let endDate = new Date(startDate.getTime() + 60*60000); // ساعة
  const start = to12Hour(startDate);
  const end = to12Hour(endDate);

  // سبب التبكير
  let early = el("earlyReport").value;
  let reasonText = "";
  if(early === "yes") {
    reasonText = `\n\n** \` سبب التبكير : ${el("earlyReason").value} \`**`;
  }

  let report = `** \`تـم اسـتـلام مـهـام ( ${task} )  من السـاعة ${start.h}:${start.m} ${start.p} اٍلـى الـساعة ${end.h}:${end.m} ${end.p} \`**\n\n`;
  report += `** \`الـمـنـطـقـة : ${loc} \`** \n\n`;
  report += `** \`الـجــهــات الامــنـيــة المـــتــواجــده : \`** \n\n`;
  report += `** \`${unitText}\`** \n\n`;
  report += `** \`تم رفـــع التـقـريـر من قبــل ( ${rank} ) :\`** <@${id}>`;
  report += reasonText;

  navigator.clipboard.writeText(report);
  alert("تم نسخ التقرير ✅");
}
</script>

</body>
</html>
