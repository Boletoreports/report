<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ© Ø§Ù„Ø°ÙƒÙŠ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');

body{
  margin:0;
  font-family:'Cairo',sans-serif;
  background:radial-gradient(circle,#1a1a1a,#050505);
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  padding-bottom:50px;
  position:relative;
  overflow-x:hidden;
  overflow-y:auto;
}

.container{
  width:90%;
  max-width:500px;
  background:rgba(20,20,20,.8);
  border-radius:20px;
  padding:35px;
  box-shadow:0 20px 50px rgba(0,0,0,.5);
  margin-top:20px;
}

h2{text-align:center;color:#00d4ff;margin-bottom:30px}
.form-group{margin-bottom:20px}
label{display:block;margin-bottom:8px;font-size:14px;color:#b0b0b0;font-weight:600}
input,select,textarea{
  width:100%;
  padding:12px;
  background:rgba(255,255,255,.05);
  border-radius:10px;
  color:#fff;
  font-family:'Cairo';
  border:1px solid rgba(255,255,255,.1);
}
select{color:#000}
textarea{height:100px;resize:vertical;overflow:auto;}
.btn-copy{
  width:100%;
  padding:15px;
  background:linear-gradient(135deg,#00829d,#00d4ff);
  border:none;
  border-radius:10px;
  color:#fff;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
}
#form-section{display:none}
</style>
</head>

<body>
<div class="container">

<div id="menu-section">
  <h2>Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h2>
  <button onclick="openForm('supervision')">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ø´Ø±Ø§Ù</button>
</div>

<div id="form-section">
  <h2 id="title-text"></h2>

  <div class="form-group">
    <label>Ø§Ù„ØªÙˆØ¬ÙŠÙ‡</label>
    <input id="taskName" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡">
  </div>

  <div class="form-group">
    <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
    <input id="location" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹">
  </div>

  <div class="form-group">
    <label>Ø§Ù„Ø±ØªØ¨Ø©</label>
    <select id="rank">
      <option>Ø±Ø§Ø¦Ø¯</option>
      <option>Ù†Ù‚ÙŠØ¨</option>
    </select>
  </div>

  <div class="form-group">
    <label>ÙƒÙˆØ¨ÙŠ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ</label>
    <input id="copyID" placeholder="Ø¶Ø¹ Ø§Ù„ÙƒÙˆØ¨ÙŠ Ø§ÙŠØ¯ÙŠ Ù‡Ù†Ø§">
  </div>

  <div class="form-group">
    <label>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù†Ø§Ø²Ù„ Ù…Ø¨ÙƒØ±ØŸ</label>
    <select id="earlySelect">
      <option value="no" selected>Ù„Ø§</option>
      <option value="yes">Ù†Ø¹Ù…</option>
    </select>
  </div>

  <!-- ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙŠØ¯ÙˆÙŠ -->
  <div class="form-group" id="manualStartGroup" style="display:none">
    <label>ÙˆÙ‚Øª Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± (ÙŠØ¯ÙˆÙŠ)</label>
    <input type="datetime-local" id="manualStart">
  </div>

  <div class="form-group" id="earlyReasonGroup" style="display:none">
    <label>Ø³Ø¨Ø¨ Ø§Ù„ØªØ¨ÙƒÙŠØ±</label>
    <select id="earlyReason">
      <option>Ø±ÙŠØ³ØªØ§Ø±Øª</option>
      <option>ØµÙŠØ§Ù†Ø©</option>
    </select>
  </div>

  <button class="btn-copy" onclick="copyReport()">Ù†Ø³Ø® Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
</div>

</div>

<script>
function el(id){return document.getElementById(id)}
let currentMode="";

function getSaudiTime(){
  let now=new Date();
  let utc=now.getTime()+now.getTimezoneOffset()*60000;
  return new Date(utc+3*3600000);
}

function formatTime(d){
  let h=d.getHours()%12||12;
  let m=d.getMinutes();
  let p=d.getHours()>=12?"Ù…":"Øµ";
  return `${h<10?"0"+h:h}:${m<10?"0"+m:m} ${p}`;
}

function openForm(type){
  currentMode=type;
  el("menu-section").style.display="none";
  el("form-section").style.display="block";
  el("earlySelect").value="no";
  toggleEarlyReason();
}

// Ø¯Ø§Ù„Ø© Ù†Ø³Ø® Ø§Ù„ØªÙ‚Ø±ÙŠØ±
function copyReport(){
  const task=el("taskName").value||"...";
  const loc=el("location").value||"...";
  const rank=el("rank").value||"...";
  const id=el("copyID").value||"0000";

  let endTime=getSaudiTime();
  let startTime;

  if(el("earlySelect").value==="yes"){
    if(!el("manualStart").value){
      alert("Ù„Ø§Ø²Ù… ØªØ­Ø¯Ø¯ ÙˆÙ‚Øª Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±");
      return;
    }
    startTime=new Date(el("manualStart").value);
  } else {
    startTime=new Date(endTime.getTime()-60*60000);
  }

  let report=
`ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù‡Ø§Ù… (${task})
Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø© ${formatTime(startTime)}
Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø§Ø¹Ø© ${formatTime(endTime)}

Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${loc}

ØªÙ… Ø±ÙØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù…Ù† Ù‚Ø¨Ù„ (${rank})
<@${id}>`;

  if(el("earlySelect").value==="yes"){
    report+=`\n\nØ³Ø¨Ø¨ Ø§Ù„ØªØ¨ÙƒÙŠØ±: ${el("earlyReason").value}`;
  }

  navigator.clipboard.writeText(report);
  alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„ØªÙ‚Ø±ÙŠØ± âœ…");
}

// ğŸ”¹ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¸Ù‡ÙˆØ± ÙˆÙ‚Øª Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠØ¯ÙˆÙŠ ÙˆØ³Ø¨Ø¨ Ø§Ù„ØªØ¨ÙƒÙŠØ±
el("earlySelect").addEventListener("change", function() {
  if (this.value === "yes") {
    el("manualStartGroup").style.display = "block"; // ÙŠØ¸Ù‡Ø± ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡
    el("earlyReasonGroup").style.display = "block"; // ÙŠØ¸Ù‡Ø± Ø³Ø¨Ø¨ Ø§Ù„ØªØ¨ÙƒÙŠØ±
  } else {
    el("manualStartGroup").style.display = "none"; // ÙŠØ®ÙÙŠÙ‡ Ù„Ùˆ Ø§Ø®ØªØ§Ø± Ù„Ø§
    el("manualStart").value = ""; // ÙŠÙ…Ø³Ø­ Ø£ÙŠ Ù‚ÙŠÙ…Ø© Ù‚Ø¯ÙŠÙ…Ø©
    el("earlyReasonGroup").style.display = "none"; // ÙŠØ®ÙÙŠ Ø³Ø¨Ø¨ Ø§Ù„ØªØ¨ÙƒÙŠØ±
  }
});
</script>
</body>
</html>
